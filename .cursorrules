# Geekbrox Project Rules
# Cursor AIê°€ ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‘ì—…í•  ë•Œ ë°˜ë“œì‹œ ì°¸ê³ í•´ì•¼ í•˜ëŠ” ê·œì¹™

---

## ğŸ”— 3-Way ê³µìœ  ìƒíƒœ ì‹œìŠ¤í…œ (í•„ìˆ˜ ì¤€ìˆ˜)

ì´ í”„ë¡œì íŠ¸ëŠ” **Claude Code, Cursor AI, Telegram Bot** 3ê°œ ë„êµ¬ê°€ í˜‘ë ¥í•˜ë©°,
`output/shared_state.json` íŒŒì¼ì„ í†µí•´ ì„œë¡œì˜ ì‘ì—… ìƒíƒœë¥¼ ì‹¤ì‹œê°„ ê³µìœ í•œë‹¤.

### Cursor AI í•„ìˆ˜ í–‰ë™ ê·œì¹™

**1. ì‘ì—… ì‹œì‘ ì‹œ ë°˜ë“œì‹œ ìƒíƒœ ë“±ë¡:**
```bash
python3 blog_automation/scripts/shared_state.py cursor start "<ì‘ì—…ì„¤ëª…>" <ìˆ˜ì •í• íŒŒì¼1> <ìˆ˜ì •í• íŒŒì¼2>
```
ì˜ˆì‹œ:
```bash
python3 blog_automation/scripts/shared_state.py cursor start "atlas_bot.py í ì‹œìŠ¤í…œ ìˆ˜ì •" blog_automation/scripts/atlas_bot.py
```

**2. ì‘ì—… ì™„ë£Œ ì‹œ ë°˜ë“œì‹œ ì™„ë£Œ ë“±ë¡:**
```bash
python3 blog_automation/scripts/shared_state.py cursor done "ì™„ë£Œ ì„¤ëª…"
```

**3. ì˜¤ë¥˜ ë°œìƒ ì‹œ:**
```bash
python3 blog_automation/scripts/shared_state.py cursor error "ì˜¤ë¥˜ ë‚´ìš©"
```

**4. í˜„ì¬ ìƒíƒœ í™•ì¸ (ì‘ì—… ì „ í•„ìˆ˜ í™•ì¸):**
```bash
python3 blog_automation/scripts/shared_state.py status
```

**5. ë©”ëª¨ ë‚¨ê¸°ê¸°:**
```bash
python3 blog_automation/scripts/shared_state.py cursor note "ì‘ì—… ì¤‘ ë°œê²¬í•œ ì‚¬í•­"
```

### ì¶©ëŒ ë°œìƒ ì‹œ ë™ì‘
- `cursor start` ëª…ë ¹ ê²°ê³¼ì— `conflicts` ë°°ì—´ì´ ë¹„ì–´ìˆì§€ ì•Šìœ¼ë©´ â†’ **ì‘ì—… ì¤‘ë‹¨**
- `severity: critical` â†’ ì¦‰ì‹œ ì¤‘ë‹¨, Steveì—ê²Œ í…”ë ˆê·¸ë¨ ì•Œë¦¼ ìë™ ì „ì†¡ë¨
- `severity: warning` â†’ Steve íŒë‹¨ í›„ ì§„í–‰ (`ì¶©ëŒ í•´ì œ` í…”ë ˆê·¸ë¨ ì…ë ¥ í›„ ì¬ì‹œë„)

### ë©”ì‹œì§€ í™•ì¸ (ì‘ì—… ì‹œì‘ ì „ ë‹¤ë¥¸ ë„êµ¬ì˜ ë©”ì‹œì§€ í™•ì¸)
```bash
python3 blog_automation/scripts/shared_state.py cursor messages
```

---

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° ë° ì €ì¥ì†Œ

```
~/Projects/geekbrox/              â† geekbrox GitHub repo (ëª¨ë“  ì‹¤ì œ ì‘ì—… ê²°ê³¼ë¬¼)
â”œâ”€â”€ blog_automation/
â”‚   â”œâ”€â”€ scripts/                  â† ë¸”ë¡œê·¸ ìë™í™” Python ìŠ¤í¬ë¦½íŠ¸
â”‚   â”‚   â”œâ”€â”€ fetch_anime.py        â€” AniList APIë¡œ ì• ë‹ˆ ì •ë³´ ìˆ˜ì§‘
â”‚   â”‚   â”œâ”€â”€ generate_post.py      â€” Claude/Geminië¡œ ë¸”ë¡œê·¸ ì´ˆì•ˆ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ post_to_tistory.py    â€” Seleniumìœ¼ë¡œ Tistory ìë™ í¬ìŠ¤íŒ…
â”‚   â”‚   â””â”€â”€ atlas_bot.py          âš ï¸ íê¸°ë¨ â€” ì ˆëŒ€ ì‹¤í–‰ ê¸ˆì§€ (ë´‡ ì¶©ëŒ)
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ anime_post_template.md
â”œâ”€â”€ teams/
â”‚   â”œâ”€â”€ game/workspace/           â† ê²Œì„ê°œë°œíŒ€ ì‘ì—… ê³µê°„
â”‚   â”‚   â”œâ”€â”€ design/               â€” GDD, ë©”ì¹´ë‹‰, ì»¨ì…‰ ë¬¸ì„œ
â”‚   â”‚   â”œâ”€â”€ art/                  â€” ì•„íŠ¸ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ, ìºë¦­í„°
â”‚   â”‚   â”œâ”€â”€ dev/                  â€” ê¸°ìˆ  ê²°ì •, ê°œë°œ ì§„í–‰
â”‚   â”‚   â””â”€â”€ sound/                â€” ì‚¬ìš´ë“œ ë°©í–¥ì„±
â”‚   â”œâ”€â”€ content/workspace/        â† ì½˜í…ì¸ íŒ€ ì‘ì—… ê³µê°„
â”‚   â”‚   â””â”€â”€ blog/                 â€” ë¸”ë¡œê·¸ ê°€ì´ë“œ, í¬ìŠ¤íŒ… ì´ë ¥
â”‚   â””â”€â”€ ops/workspace/            â† ìš´ì˜ë°ì‚¬ì—…íŒ€ ì‘ì—… ê³µê°„
â”‚       â”œâ”€â”€ research/game-research/ â€” ê²Œì„ ì‹œì¥ ë¦¬ì„œì¹˜
â”‚       â””â”€â”€ monetization/         â€” ë§ˆì¼€íŒ… í”Œëœ, ìœ ë£Œí™” ëª¨ë¸
â”œâ”€â”€ output/                       â† ëŸ°íƒ€ì„ ìƒì„± íŒŒì¼ (git ì œì™¸)
â”‚   â”œâ”€â”€ posts/                    â€” ìƒì„±ëœ ë¸”ë¡œê·¸ ì´ˆì•ˆ md
â”‚   â””â”€â”€ images/                   â€” ë‹¤ìš´ë¡œë“œëœ ì´ë¯¸ì§€
â”œâ”€â”€ .env                          â† API í‚¤ (git ì œì™¸, ì ˆëŒ€ ì»¤ë°‹ ê¸ˆì§€)
â””â”€â”€ requirements.txt
```

**ì €ì¥ì†Œ ë¶„ë¦¬ ì›ì¹™:**
- `~/.openclaw/` â†’ OpenClaw AI ì—ì´ì „íŠ¸ **ì„¤ì •Â·ê¸°ì–µ** ì „ìš© (`openclaw-config` repo)
- `~/Projects/geekbrox/` â†’ **ëª¨ë“  ì‹¤ì œ ì‘ì—… ê²°ê³¼ë¬¼** (`geekbrox` repo)
- ì‘ì—… ê²°ê³¼ë¬¼ì„ `~/.openclaw/workspace/`ì— ì €ì¥í•˜ì§€ ë§ ê²ƒ

---

## ğŸ¤– OpenClaw ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

ì´ í”„ë¡œì íŠ¸ëŠ” OpenClaw ë©€í‹° ì—ì´ì „íŠ¸ë¡œ ìš´ì˜ëœë‹¤. Cursor AIëŠ” ì½”ë“œ ì‘ì—… ì‹œ ì´ êµ¬ì¡°ë¥¼ ì¸ì§€í•˜ê³  í˜‘ë ¥í•œë‹¤.

```
Steve (Telegram)
    â†•
ğŸš€ Atlas â€” ì´ê´„ PM  (Gemini 2.5 Flash, ~/.openclaw/workspace/)
    â”‚  ì—­í• : Steve ì†Œí†µ, ìœ„ì„, ê²°ê³¼ í†µí•© ë³´ê³ . ì‹¤ë¬´ ì§ì ‘ ì²˜ë¦¬ ì—†ìŒ.
    â”‚
    â”œâ”€â”€ ğŸ“ ì½˜í…ì¸ íŒ€ì¥  (Claude Sonnet 4.5 + Gemini fallback)
    â”‚   workspace: teams/content/workspace/
    â”‚   ë‹´ë‹¹: ë¸”ë¡œê·¸Â·SNSÂ·ìœ íŠœë¸Œ ìë™í™”
    â”‚
    â”œâ”€â”€ ğŸ® ê²Œì„ê°œë°œíŒ€ì¥  (Claude Sonnet 4.5 + Gemini fallback)
    â”‚   workspace: teams/game/workspace/
    â”‚   ë‹´ë‹¹: GDD, ê°œë°œ, ì•„íŠ¸, ì‚¬ìš´ë“œ
    â”‚
    â””â”€â”€ ğŸ¢ ìš´ì˜ë°ì‚¬ì—…íŒ€ì¥  (Claude Sonnet 4.5 + Gemini fallback)
        workspace: teams/ops/workspace/
        ë‹´ë‹¹: ë¦¬ì„œì¹˜, ìœ ë£Œí™”, QA
```

**Cursor AI ì—­í• :** ê° íŒ€ì¥ ì—ì´ì „íŠ¸ì˜ ì§€ì‹œì— ë”°ë¼ ì½”ë“œë¥¼ ì‘ì„±Â·ìˆ˜ì •í•œë‹¤.
ì‘ì—… ê²°ê³¼ëŠ” í•´ë‹¹ íŒ€ì˜ `workspace/dev/` ë˜ëŠ” `blog_automation/scripts/`ì— ì €ì¥í•œë‹¤.

---

## ğŸ® í˜„ì¬ í”„ë¡œì íŠ¸ í˜„í™©

### 1. ë¸”ë¡œê·¸ ìë™í™” (ì½˜í…ì¸ íŒ€)
- **í”Œë«í¼:** Tistory (https://geekbrox.tistory.com)
- **ì™„ë£Œ:** 4ê±´ (Hell's Paradise S2, Fire Force S3P2, Frieren S2, Fate/strange Fake)
- **ëŒ€ê¸°:** 9ê±´ (JUJUTSU KAISEN S3, OSHI NO KO S3 ë“±)
- **AI:** generate_post.py â€” Claude ìš°ì„ , ê³¼ë¶€í•˜ ì‹œ Gemini ìë™ fallback

### 2. ì¸ë””ê²Œì„ ê°œë°œ (ê²Œì„íŒ€)
- **ì¥ë¥´:** ë¡œê·¸ë¼ì´í¬ + ë°©ì¹˜í˜• + ë±ë¹Œë”© í•˜ì´ë¸Œë¦¬ë“œ
- **í˜„ì¬ ë‹¨ê³„:** Phase 0 (ì»¨ì…‰ í™•ì • ëŒ€ê¸°)
- **GDD ì™„ì„±ë³¸:**
  - `teams/game/workspace/design/GDD_Dream_Collector.md` â­ Atlas ì¶”ì²œ
  - `teams/game/workspace/design/GDD_Dungeon_Parasite.md`
- **ì—”ì§„:** ì»¨ì…‰ í™•ì • í›„ Unity/Godot ê²°ì •

---

## ğŸ” í™˜ê²½ë³€ìˆ˜ (.env)

```
ANTHROPIC_API_KEY=...      â† Claude API
GOOGLE_API_KEY=...         â† Gemini API (fallbackìš©)
TISTORY_ACCESS_TOKEN=...   â† Tistory í¬ìŠ¤íŒ…
KAKAO_REST_API_KEY=...     â† Kakao OAuth
```

**ì ˆëŒ€ ê·œì¹™:** `.env` íŒŒì¼ì„ gitì— ì»¤ë°‹í•˜ì§€ ë§ ê²ƒ. `cookies.json`ë„ ë™ì¼.

---

## ğŸ ì½”ë”© ê·œì¹™

- **ì–¸ì–´:** Python 3.12 (`.venv/` ê°€ìƒí™˜ê²½ ì‚¬ìš©)
- **ì£¼ì„:** í•œêµ­ì–´
- **ì—ëŸ¬ ì²˜ë¦¬:** ëª¨ë“  API í˜¸ì¶œì— `try/except` í•„ìˆ˜
- **í™˜ê²½ë³€ìˆ˜:** API í‚¤ëŠ” ë°˜ë“œì‹œ `.env` + `python-dotenv` ì‚¬ìš©
- **AI API í˜¸ì¶œ:** Claude ìš°ì„ , `overloaded_error` / `rate_limit_error` ì‹œ Geminië¡œ fallback

### API fallback íŒ¨í„´ (generate_post.py ê¸°ì¤€)
```python
def _is_rate_limit_error(e: Exception) -> bool:
    msg = str(e).lower()
    return any(kw in msg for kw in ("rate_limit", "rate limit", "429", "too many requests", "overloaded"))

# Claude ìš°ì„  ì‹œë„ â†’ ì‹¤íŒ¨ ì‹œ Gemini fallback
try:
    # Anthropic Claude
    ...
except Exception as e:
    if _is_rate_limit_error(e):
        # Gemini fallback
        from google import genai
        client = genai.Client(api_key=os.environ["GOOGLE_API_KEY"])
        ...
    else:
        raise
```

---

## ğŸŒ ì£¼ìš” API

| API | ìš©ë„ | ì¸ì¦ ë°©ì‹ |
|-----|------|-----------|
| AniList (GraphQL) | ì• ë‹ˆ ì •ë³´ ìˆ˜ì§‘ | ê³µê°œ API (í‚¤ ë¶ˆí•„ìš”) |
| Anthropic Claude | ë¸”ë¡œê·¸ ì´ˆì•ˆ ìƒì„± | `ANTHROPIC_API_KEY` |
| Google Gemini | Claude fallback | `GOOGLE_API_KEY` |
| Tistory | ë¸”ë¡œê·¸ í¬ìŠ¤íŒ… | `TISTORY_ACCESS_TOKEN` + Selenium |
| Kakao OAuth | Tistory ì¸ì¦ ê°±ì‹  | `KAKAO_REST_API_KEY` |

---

## ğŸ§ª í‹°ìŠ¤í† ë¦¬ Selenium ìë™í™” í•µì‹¬ ì§€ì‹ (post_to_tistory.py)

### ì—ë””í„° êµ¬ì¡°
- Tistory ì—ë””í„°: **TinyMCE(keditor)** ê¸°ë°˜ (ë ˆê±°ì‹œ)
- ì—ë””í„° ID: `editor-tistory` (TinyMCE ì¸ìŠ¤í„´ìŠ¤)
- ì—ë””í„° iframe: `id="editor-tistory_ifr"` â€” ë³¸ë¬¸ í¸ì§‘ ì˜ì—­
- ë³¸ë¬¸ ìš”ì†Œ: iframe ë‚´ë¶€ `body#tinymce` (contenteditable)

### ì´ë¯¸ì§€ ì—…ë¡œë“œ ë™ì‘ ë°©ì‹ (í™•ì¸ ì™„ë£Œ)
- ì²¨ë¶€ ë²„íŠ¼: `div[aria-label="ì²¨ë¶€"]` (ë¶€ëª¨ div, ì‹¤ì œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬)
  - ë‚´ë¶€ button: `id="attach-layer-btn"`, `rect={w:0,h:0}` â†’ EC.element_to_be_clickable ë¶ˆê°€
  - **JS click() ë¡œ ê°•ì œ í´ë¦­ í•„ìš”**
- í´ë¦­ ì‹œ DOMì— ë™ì  ìƒì„±: `input#attach-image` (accept="image/*")
- âš ï¸ **toggle ë°©ì‹**: ë‘ ë²ˆ í´ë¦­í•˜ë©´ inputì´ ì‚¬ë¼ì§ â†’ ì¬í´ë¦­ ì ˆëŒ€ ê¸ˆì§€
- âš ï¸ TinyMCE iframeì— í¬ì»¤ìŠ¤ê°€ ìˆì–´ì•¼ ì²¨ë¶€ ë²„íŠ¼ì´ ì •ìƒ ì‘ë™
- ì—…ë¡œë“œ ë°©ë²•: `_make_file_input_visible()` â†’ `file_input.send_keys(ì ˆëŒ€ê²½ë¡œ)`

### ì—…ë¡œë“œ ìˆœì„œ (upload_image_to_editor í•¨ìˆ˜) â€” ì‹¤ì œ ë™ì‘ í™•ì¸ ê¸°ì¤€
1. **ë°©ë²•1 (ì£¼ë ¥, ì‹¤ì œ ì„±ê³µ í™•ì¸)**: `editor-tistory_ifr` iframeì˜ `body#tinymce`ì— DataTransfer ë“œë¡­ ì´ë²¤íŠ¸ ë°œìƒ
   - Tistory keditorì˜ `fileUpload` / `kImage` í”ŒëŸ¬ê·¸ì¸ì´ drop ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•´ ì´ë¯¸ì§€ ì„œë²„ ì—…ë¡œë“œ
   - `new DragEvent('drop', {dataTransfer: dt})` â†’ `body.dispatchEvent(ev)`
2. **ë°©ë²•2 (fallback)**: `div[aria-label="ì²¨ë¶€"]` JS click() â†’ `#attach-image` input ë™ì  ìƒì„± â†’ `send_keys(ì ˆëŒ€ê²½ë¡œ)`
   - âš ï¸ toggle ë°©ì‹: ë‘ ë²ˆ í´ë¦­í•˜ë©´ inputì´ ì‚¬ë¼ì§ â†’ ì¬í´ë¦­ ì ˆëŒ€ ê¸ˆì§€
   - âš ï¸ í´ë¦­ ì „ iframe í¬ì»¤ìŠ¤ í™œì„±í™” í•„ìš”
3. **ë°©ë²•3**: ë©”ì¸ DOM `input[type='file']` ì§ì ‘ íƒìƒ‰ â†’ `send_keys()`

### í•´ì‹œíƒœê·¸/ë³¸ë¬¸ ì…ë ¥
- `editor-tistory_ifr` iframe ì „í™˜ í›„ `body#tinymce` ì—ì„œ Cmd+End â†’ í´ë¦½ë³´ë“œ ë¶™ì—¬ë„£ê¸°
- í•œêµ­ì–´ ì…ë ¥: pbcopy(macOS) / xclip(Linux) + Cmd/Ctrl+V

### ë°œí–‰ í”Œë¡œìš° (í™•ì¸ ì™„ë£Œ)
1. `#publish-layer-btn` í´ë¦­ â†’ ë°œí–‰ íŒ¨ë„ ì—´ê¸°
2. `#open20` ë¼ë””ì˜¤ë²„íŠ¼ í´ë¦­ â†’ ê³µê°œ ì„¤ì •
3. `#publish-btn` í´ë¦­ â†’ ë°œí–‰
4. URLì´ newpostì—ì„œ ë²—ì–´ë‚˜ë©´ ì„±ê³µ

### ì¹´í…Œê³ ë¦¬
- `select#category` ë¡œ ì§ì ‘ ì„ íƒ (ì—ë””í„° ë¡œë“œ ì§í›„ ê°€ëŠ¥)
- ëŒ€ìƒ ì¹´í…Œê³ ë¦¬: "ì• ë‹ˆì†Œê°œ ë° ë¦¬ë·°"

### write_post() ì „ì²´ ì‹¤í–‰ íë¦„ (í™•ì¸ ì™„ë£Œ)
1. `safe_get(NEWPOST_URL)` â†’ `wait_for_editor()` â€” ì—ë””í„° ë¡œë”© ëŒ€ê¸°
2. `set_category()` â€” `select#category` ë¡œ ì¹´í…Œê³ ë¦¬ ì„ íƒ
3. `upload_image_to_editor()` â€” DataTransfer drop ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ ì‚½ì… (ë°©ë²•1)
4. `input#post-title-inp` â€” ì œëª© í´ë¦½ë³´ë“œ ë¶™ì—¬ë„£ê¸°
5. `editor-tistory_ifr` iframe ë‚´ `body#tinymce` â€” ë³¸ë¬¸ í´ë¦½ë³´ë“œ ë¶™ì—¬ë„£ê¸°
6. í•´ì‹œíƒœê·¸ 10ê°œ â€” iframe ë‚´ `body#tinymce` Cmd+End í›„ ë¶™ì—¬ë„£ê¸°
7. Telegram 'í¬ìŠ¤íŒ…' í‚¤ì›Œë“œ ìˆ˜ì‹  ëŒ€ê¸°
8. `#publish-layer-btn` â†’ `#open20` â†’ `#publish-btn` â€” ë°œí–‰

### ì¤‘ìš” ì£¼ì˜ì‚¬í•­
- `EC.element_to_be_clickable` ë¡œ ì°¾ì„ ìˆ˜ ì—†ëŠ” ìˆ¨ê²¨ì§„ ë²„íŠ¼ì€ `driver.execute_script("...click()")` ì‚¬ìš©
- iframe ì „í™˜ í›„ ë°˜ë“œì‹œ `driver.switch_to.default_content()` ë³µê·€ í•„ìš”
- í•œêµ­ì–´ í…ìŠ¤íŠ¸ëŠ” ë°˜ë“œì‹œ í´ë¦½ë³´ë“œ(pbcopy) ê²½ìœ  ë¶™ì—¬ë„£ê¸° â€” `send_keys()` ì§ì ‘ ì…ë ¥ ì‹œ ê¹¨ì§
- `dismiss_alert_if_present()` ë¥¼ ì£¼ìš” ë‹¨ê³„ë§ˆë‹¤ í˜¸ì¶œí•´ ì´ì–´ì„œ ì‘ì„± íŒì—… ì²˜ë¦¬
- ì´ë¯¸ì§€ íŒŒì¼: `output/images/` í´ë”, md íŒŒì¼ëª…ê³¼ ë™ì¼í•œ stemìœ¼ë¡œ ì €ì¥
- ì™„ë£Œëœ md íŒŒì¼: `output/posts/done/` ìœ¼ë¡œ ìë™ ì´ë™
